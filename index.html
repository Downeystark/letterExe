<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title></title>
<link href="index.css" rel="stylesheet">
<link href="css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<textarea id="source" rows="20" cols="100">
<h1>dfdfd</h1>
<div >sadf
asdf</div>
<h2>dfdfd</h2>
<p>dfasdf</p>
<img src="x1" alt="">
<a href="">test</a>
<div>sadfasdf</div>
<ul class="search-nav">
<li>asdf
</li>

 </ul>
<img src="x2" alt="">
</textarea>

<textarea id="compiled" rows="20" cols="100"></textarea>

<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript">
	$(function(){
		
		String.prototype.getQuery = function(Startname,endName){ 
			var reg = new RegExp('(^|\\<)'+Startname+' ([^<]*|\/|>$)');
			var url = this.toString();
			var r = url.match(reg);
			//console.log(r);
			return r === null ? null : unescape(r[0].replace(Startname,endName).replace('/','').replace('>','></'+endName+'>')); 
		}
		
		
		var str = 'http://wpa.qq.com/msgrd?v=3&uin=1438344583&site=q q&menu=yes<img src="adsfsda" />'; 
		
		$('#source').keyup(function(){
			var s = $(this).val();
			$('#compiled').val(compoled.exe(s));
		})
		
		String.prototype.regexp = function(laber,repStr,end){
			var str = this.toString();
			var reg = eval('/<'+laber+'\\s(.*?)?>/g');
			//console.log(reg);
			str = str.replace(reg,'<'+repStr+' $1></'+repStr+'>');
			//console.log(str);
			return str;
		}
		
		var compoled = {
			exe : function(data){
				var label = ['div','p','h[1-7]','a','table','tr','td','th','ul','ol','li','strong','span','i'];
				
				for(k in label){
					var regexpStart = eval('/<'+label[k]+'([\\s\\S]*?)<\\/'+label[k]+'>/g');
					data = data.replace(regexpStart,function(str,match,length){
						var repStart = '<view'+match+'<view>';
						console.log(str);
						console.log(match);
						return repStart;
					});
				}
				
				data = data.regexp('img','image');
				return data;
			},
			
			
		}
		
		$('#source').keyup();
		
	})
</script>
</body>
</html>